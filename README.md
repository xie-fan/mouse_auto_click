# 鼠标自动点击工具

一个功能强大的Python鼠标自动化工具，支持坐标记录和自动点击功能。

## 功能特性

### 1. 鼠标坐标记录
- 实时记录鼠标点击位置的坐标
- 支持保存坐标到JSON文件
- 可视化显示已记录的坐标点

### 2. 自动点击
- 按照配置的多个位置依次自动点击
- 可自定义每次点击之间的时间间隔
- 支持热键控制（启动、暂停、停止）
- 可以从文件加载坐标或手动输入坐标

## 安装依赖

```bash
pip install -r requirements.txt
```

所需的Python库：
- `pyautogui` - 用于模拟鼠标点击
- `pynput` - 用于监听鼠标和键盘事件

## 使用方法

### 运行程序

```bash
python mouse_auto_clicker.py
```

### 功能选项

程序启动后会显示菜单，包含以下选项：

#### 1. 记录鼠标点击坐标
- 选择此选项后，点击你想要自动点击的位置
- 每次点击都会记录当前坐标
- 按 `ESC` 键停止记录
- 记录完成后可以选择保存到 `coordinates.json` 文件

#### 2. 使用已保存的坐标进行自动点击
- 从 `coordinates.json` 文件加载之前保存的坐标
- 设置点击间隔时间（秒）
- 使用热键控制自动点击

#### 3. 手动输入坐标进行自动点击
- 手动输入要点击的坐标（格式：`x,y`）
- 每行输入一个坐标
- 输入空行结束
- 设置点击间隔时间并开始自动点击

#### 4. 退出程序

### 热键控制

在自动点击模式下，可以使用以下热键：

- `F1` - 开始/恢复自动点击
- `F2` - 暂停自动点击
- `F3` - 停止自动点击并退出
- `ESC` - 退出程序

## 使用示例

### 示例1：记录并保存坐标

1. 运行程序，选择选项 `1`
2. 依次点击你想要自动点击的位置
3. 按 `ESC` 停止记录
4. 输入 `y` 保存坐标到文件

### 示例2：使用保存的坐标自动点击

1. 运行程序，选择选项 `2`
2. 程序会加载 `coordinates.json` 中的坐标
3. 输入点击间隔时间，例如 `2` (2秒)
4. 按 `F1` 开始自动点击
5. 按 `F2` 暂停，按 `F1` 继续
6. 按 `F3` 或 `ESC` 退出

### 示例3：手动输入坐标

1. 运行程序，选择选项 `3`
2. 输入坐标，例如：
   ```
   100,200
   300,400
   500,600
   (按回车输入空行结束)
   ```
3. 输入点击间隔时间
4. 使用热键控制自动点击

## 坐标文件格式

保存的坐标文件 `coordinates.json` 格式如下：

```json
[
  [100, 200],
  [300, 400],
  [500, 600]
]
```

## 安全特性

- 启用了 `pyautogui.FAILSAFE`：将鼠标移动到屏幕左上角可以中断程序
- 支持热键快速停止自动点击
- 所有点击操作都有间隔时间，避免过快点击

## 注意事项

1. **权限要求**：
   - macOS: 需要授予终端辅助功能权限（系统偏好设置 > 安全性与隐私 > 辅助功能）
   - Linux: 可能需要安装 `python3-xlib`
   
2. **安全使用**：
   - 在使用自动点击功能前，确保了解点击位置和间隔时间
   - 避免在重要操作界面使用，防止误操作
   
3. **紧急停止**：
   - 随时可以将鼠标移动到屏幕左上角触发 FAILSAFE
   - 按 `F3` 或 `ESC` 停止程序

## 技术实现

- 使用 `pyautogui` 实现鼠标点击模拟
- 使用 `pynput` 监听鼠标和键盘事件
- 使用多线程实现非阻塞的自动点击
- 使用 JSON 格式存储坐标数据

## 许可证

MIT License
